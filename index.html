<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather App</title>
  </head>
  <body>
    <h1>Welcome to Weather App</h1>
    <p>Get the latest weather updates for your location.</p>
    <input id="input" type="text" placeholder="Enter city name" />
    <button id="btn">Get Weather</button>
    <h2 id="temp">Nhiệt độ:</h2>
  </body>
  <script>
    async function getWeather(lat, lon) {
      const response = await fetch(
        `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m`
      );
      const data = await response.json();

      let tempp = data.current.temperature_2m;

      document.querySelector('#temp').innerText = `Nhiệt độ: ${tempp}°C`;
    }

    let searchButton = document.querySelector('#btn');
    searchButton.addEventListener('click', async () => {
      let inputElement = document.querySelector('#input');
      let cityName = inputElement.value;
      if (!cityName) {
        alert('Please enter a city name.');
        return;
      }
      try {
        const response = await fetch(
          `https://geocoding-api.open-meteo.com/v1/search?name=${cityName}&count=10&language=en&format=json`
        );
        const data = await response.json();

        // Không có thành phố nào được tìm thấy thì bỏ qua
        if (!data.results) {
          alert('City not found. Please try again.');
          return;
        }
        let lat = data.results[0].latitude;
        let lon = data.results[0].longitude;

        getWeather(lat, lon);
      } catch (error) {
        console.error('Error fetching location data:', error);
      }
    });
  </script>
</html>
